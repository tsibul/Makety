{% extends 'maket/main.html' %}
{% block title %}Макеты{% endblock %}
{% block content %}
{% include 'maket/reload.html' %}

<div class="p-1 m-1"> <h5>Список Заказов &nbsp;
<!-- Button trigger modal -->
<button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">
    Загрузить заказ
</button><!-- Button trigger modal -->
</h5></div>

<!-- Modal -->
<form id="import_order" action="{% url 'maket:import_order' %}" method="post" enctype="multipart/form-data">
{% csrf_token %}
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Выберите файл</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
         <!-- Выбор файла --->
         <label class="custom-file-label" for="ChoseCSV"></label>
         <input type="file" accept=".html" class="custom-file-input col-auto border" id="ChoseCSV" name="Chosen">
<!--         <input type="submit" name="submit" value="Upload" /><--->
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Закрыть</button>
        <button type="submit" name="submit" class="btn btn-primary" >Загрузить</button>
      </div>
    </div>
  </div>
</div>
</form><!-- Modal Import order -->

<div class="overflow-auto" style="max-height: 600px">
<table class="table table-info table-hover" style="font-size:90%;">
    <tbody >
    {% for ord in orders %}
    <tr ondblclick="window.location.href='{{ord.id}}'" class="align-middle
           {%  if ord.maket_status == 'R' %} text-success{% elif ord.maket_status == 'N' %} text-danger {% endif %}">
        <td class="fw-bold" >
            <select class="form-select bg-info bg-opacity-10 {% if ord.maket_status == 'R' %}text-success"
                    {% elif ord.maket_status == 'N' %}text-danger {% endif %}" style="font-size:100%;"
                    id="status_{{ord.id}}" onchange="location = this.options[this.selectedIndex].value;">
                <option value="{% url 'maket:maket_status' id=ord.id status='N' source='order' %}"
                {% if ord.maket_status == 'N' %} selected {% endif %}><button class="btn btn-sm btn-outline-danger"> не готово </button></option>
                <option value="{% url 'maket:maket_status' id=ord.id status='P' source='order' %}"
                {% if ord.maket_status == 'P' %} selected {% endif %}> частично </option>
                <option value="{% url 'maket:maket_status' id=ord.id status='R' source='order' %}"
                {% if ord.maket_status == 'R' %} selected {% endif %}><div class="text-success"> готово&nbsp;&nbsp; </div></option>
            </select>
        </td>
        <td >{{ord.order_id}}</td>
        <td>{{ord.order_date|date:'d.m.Y'}}</td>
{% if 'Сувенир' in ord.supplier %}
        <td> ВВС </td>
{% elif 'Студия' in ord.supplier %}
        <td> ССП </td>
{% else %}
        <td> ВВ </td>
{% endif %}
        <td class="text-wrap" style="max-width:440px"> {{ord.customer_name}}</td>
        <td> {{ord.manager.manager}}</td>
        <td class="text-break"> {{ord.manager.manager_mail}}</td>
        <td class="text-end"> {{ord.order_sum}}</td>
<!--        <td> {{ord.customer_INN}}</td><--->
<!--        <td> {{ord.film.film_id}}</td>
        <td> {{ord.film.date}}</td>
        {% if ord_imp.film_status %}
            <td class="align-middle"><input class="form-check-input" type="checkbox" checked disabled></td>
        {% else %}
            <td class="align-middle"><input class="form-check-input" type="checkbox" checked disabled></td>
        {% endif %}--->
         </td>
        <td class="align-middle"><a href="delete_order/{{ ord.id }}">
            <button type="submit" class="btn btn-sm btn-outline-danger" style="font-size:80%;">Удалить</button>
        </a></td>
    </tr>
    {% endfor %}
    </tbody>
</table>
</div><!-- Table of orders -->







<div>
</div>

{% endblock %}